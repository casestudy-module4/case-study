    <!DOCTYPE html>
    <html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>Home</title>
        <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
        <link rel="stylesheet" th:href="@{/style.css}">

    </head>
    <body>
    <div class="wrapper">
        <div th:replace="fragment/sidebar.html :: sidebar"></div>
        <div class="main p-4">
            <div class="d-flex justify-content-end mb-3">
                <form class="d-flex" style="width: 20%;" role="search" method="get" action="/admins">
                    <input class="form-control me-2" type="search" name="name" placeholder="Search..." aria-label="Search">
                    <button class="btn btn-outline-success bi bi-search" type="submit"></button>
                </form>
            </div>
            <div class="text-center mb-4">
                <h1>Product Management</h1>
            </div>
            <div class="d-flex justify-content-end mb-3">
                <button class="btn mb-3 btn-sm" data-bs-toggle="modal" data-bs-target="#addProductModal" style="border: black solid 1px">
                    Add Product
                </button>
            </div>
            <table class="table table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Name</th>
                    <th scope="col">Category</th>
                    <th scope="col">Image</th>
                    <th scope="col">Price</th>
                    <th scope="col">Action</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="product, stat : ${products}">
                    <th scope="row" th:text="${stat.count}"></th>
                    <td th:text="${product.name}"></td>
                    <td th:text="${product.category?.nameCategory}"></td>
                    <td>
                        <img th:src="${product.image}" th:alt="'Image of ' + ${product.name}" class="w-70 text-center" width="70" th:onclick="viewImage(this.getAttribute('src'))" />
                    </td>
                    <td th:text="${product.price}"></td>
                    <td>
                        <a href="#"
                           class="btn btn-sm "
                           th:data-id="${product.id}"
                           th:data-name="${product.name}"
                           th:onclick="updateModal(this.getAttribute('data-id'), this.getAttribute('data-name'))">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <a href="#"
                           class="btn btn-sm bi bi-trash3"
                           th:data-id="${product.id}"
                           th:data-name="${product.name}"
                           th:onclick="deleteModal(this.getAttribute('data-id'), this.getAttribute('data-name'))">
                        </a>
                        <a href="#" class="btn btn-link" data-bs-toggle="tooltip" title="View Details"
                            th:data-id="${product.id}"
                           th:data-name="${product.name}"
                           th:data-price="${product.price}"
                           th:data-description="${product.description}"
                           th:data-productPackagingDate="${product.productPackagingDate}"
                           th:data-totalProductQuantity="${product.totalProductQuantity}"
                           th:data-remainProductQuantity="${product.remainProductQuantity}"
                           th:data-image="${product.image}"
                           th:data-category="${product.category?.nameCategory}"
                           th:onclick="detailModal(this.getAttribute('data-id'), this.getAttribute('data-name'), this.getAttribute('data-price'),
                            this.getAttribute('data-description'), this.getAttribute('data-productPackagingDate'), this.getAttribute('data-totalProductQuantity'),
                            this.getAttribute('data-remainProductQuantity'), this.getAttribute('data-category'), this.getAttribute('data-image'))">
                            <i class="bi bi-info-circle"></i>
                        </a>
                    </td>
                </tr>
                <tr th:if="${products.content.isEmpty()}">
                    <td colspan="6" class="text-center">No Products Found</td>
                </tr>
                </tbody>
            </table>
            <div th:if="${products != null}">
                <div class="pagination">
                    <button th:if="${products.hasPrevious()}" class="btn btn-outline-primary"
                            th:attr="onclick='location.href=\'/admins/home?page=' + ${products.number - 1} + '\''" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </button>
                    <button th:if="${products.hasNext()}" class="btn btn-outline-primary"
                            th:attr="onclick='location.href=\'/admins/home?page=' + ${products.number + 1} + '\''" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </button>
                </div>
            </div>
            <div th:if="${message != null}" id="message-container">
                <strong><p style="color:green;" th:text="${message}"></p></strong>
            </div>
            <div th:if="${error != null}">
                <strong><p style="color:red;" th:text="${error}"></p></strong>
            </div>
        </div>
    </div>


    <div th:replace="product/fragment :: modal-delete"></div>
    <div th:replace="product/fragment :: modal-confirm-update"></div>
    <div th:replace="product/fragment :: modal-update"></div>
    <div th:replace="product/fragment :: modal-create"></div>
    <div th:replace="product/fragment :: modal-detail"></div>
    <div th:replace="product/fragment :: modal-viewImage"></div>
    <script th:src="@{/script.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
    </script>
    <script>

        var messageContainer = document.getElementById('message-container');
        if (messageContainer) {
            setTimeout(function() {
                messageContainer.style.display = 'none';
            }, 3000);
        }
    </script>
    <script th:inline="javascript">
        function updateModal(productId, productName){
            document.getElementById("productIdToUpdate").innertText = productId;
            document.getElementById("productNameToUpdate").innerText = productName;
            document.getElementById("updateProductModalLabel").innerText = "Update Product "+ productName + " with - ID: " + productId;
            let updateLink = "/admins/home/" + productId + "/update" ;
            let form = document.querySelector('#updateProductModal form');
            form.setAttribute("action", updateLink);

            let myModal = new bootstrap.Modal(document.getElementById('updateProductModal'));
            myModal.show();
        }
    </script>
    <script>
        function detailModal(id, name, price, description, packing, totalQuantity, remainQuantity, category, image) {
            document.getElementById("productId").innerText = id;
            document.getElementById("productNames").innerText = name;
            document.getElementById("productPrices").innerText = price;
            document.getElementById("productDescriptions").innerText = description;
            document.getElementById("productPackagingDates").innerText = packing;
            document.getElementById("totalsProductQuantity").innerText = totalQuantity;
            document.getElementById("remainProductQuantity").innerText = remainQuantity;
            document.getElementById("productCategory").innerText = category;
            document.getElementById("productImage").src = image;

            const productImage = document.getElementById("productImage");
            if (image) {
                productImage.src = image;
                productImage.alt = `Image of ${name}`;
            } else {
                productImage.src = "https://via.placeholder.com/500";
                productImage.alt = "No image available";
            }
            let myModal = new bootstrap.Modal(document.getElementById('productDetailModal'));
            myModal.show();
        }

    </script>
    <script th:inline="javascript">
        function deleteModal(productId, productName){
            document.getElementById("productIdToDelete").innerText = productId;
            document.getElementById("productNameToDelete").innerText = productName;
            let deleteLink = "/admins/home/" + productId + "/delete";
            document.getElementById("deleteButton").setAttribute("href", deleteLink);
            let myModal = new bootstrap.Modal(document.getElementById('confirmDeleteModal'));
            myModal.show();
        }
    </script>
    <script>
        function viewImage(imageSrc) {
            document.getElementById("previewImage").src = imageSrc;
            var imagePreviewModal = new bootstrap.Modal(document.getElementById("imagePreviewModal"));
            imagePreviewModal.show();
        }
    </script>
    </body>
    </html>
